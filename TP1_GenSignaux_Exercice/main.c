#include "dsk6713_aic23.h"

Uint32 input_left_sample();
void output_left_sample(int out_data);
void comm_intr();

#define		N		480

short SinTable[480] = {
0, 54, 107, 161, 214, 268, 321, 375, 428, 481, 535, 588, 641, 694, 746, 799,
852, 904, 956, 1008, 1060, 1112, 1163, 1215, 1266, 1317, 1367, 1418, 1468, 1518, 1567, 1617,
1666, 1715, 1763, 1812, 1860, 1907, 1954, 2001, 2048, 2094, 2140, 2186, 2231, 2276, 2320, 2364,
2408, 2451, 2493, 2536, 2578, 2619, 2660, 2701, 2741, 2780, 2820, 2858, 2896, 2934, 2971, 3008,
3044, 3080, 3115, 3149, 3183, 3217, 3250, 3282, 3314, 3345, 3376, 3406, 3435, 3464, 3492, 3520,
3547, 3574, 3600, 3625, 3650, 3674, 3697, 3720, 3742, 3763, 3784, 3804, 3824, 3843, 3861, 3879,
3896, 3912, 3927, 3942, 3956, 3970, 3983, 3995, 4006, 4017, 4027, 4037, 4046, 4054, 4061, 4068,
4074, 4079, 4083, 4087, 4090, 4093, 4095, 4096, 4096, 4096, 4095, 4093, 4090, 4087, 4083, 4079,
4074, 4068, 4061, 4054, 4046, 4037, 4027, 4017, 4006, 3995, 3983, 3970, 3956, 3942, 3927, 3912,
3896, 3879, 3861, 3843, 3824, 3804, 3784, 3763, 3742, 3720, 3697, 3674, 3650, 3625, 3600, 3574,
3547, 3520, 3492, 3464, 3435, 3406, 3376, 3345, 3314, 3282, 3250, 3217, 3183, 3149, 3115, 3080,
3044, 3008, 2971, 2934, 2896, 2858, 2820, 2780, 2741, 2701, 2660, 2619, 2578, 2536, 2493, 2451,
2408, 2364, 2320, 2276, 2231, 2186, 2140, 2094, 2048, 2001, 1954, 1907, 1860, 1812, 1763, 1715,
1666, 1617, 1567, 1518, 1468, 1418, 1367, 1317, 1266, 1215, 1163, 1112, 1060, 1008, 956, 904,
852, 799, 746, 694, 641, 588, 535, 481, 428, 375, 321, 268, 214, 161, 107, 54,
0, -54, -107, -161, -214, -268, -321, -375, -428, -481, -535, -588, -641, -694, -746, -799,
-852, -904, -956, -1008, -1060, -1112, -1163, -1215, -1266, -1317, -1367, -1418, -1468, -1518, -1567, -1617,
-1666, -1715, -1763, -1812, -1860, -1907, -1954, -2001, -2048, -2094, -2140, -2186, -2231, -2276, -2320, -2364,
-2408, -2451, -2493, -2536, -2578, -2619, -2660, -2701, -2741, -2780, -2820, -2858, -2896, -2934, -2971, -3008,
-3044, -3080, -3115, -3149, -3183, -3217, -3250, -3282, -3314, -3345, -3376, -3406, -3435, -3464, -3492, -3520,
-3547, -3574, -3600, -3625, -3650, -3674, -3697, -3720, -3742, -3763, -3784, -3804, -3824, -3843, -3861, -3879,
-3896, -3912, -3927, -3942, -3956, -3970, -3983, -3995, -4006, -4017, -4027, -4037, -4046, -4054, -4061, -4068,
-4074, -4079, -4083, -4087, -4090, -4093, -4095, -4096, -4096, -4096, -4095, -4093, -4090, -4087, -4083, -4079,
-4074, -4068, -4061, -4054, -4046, -4037, -4027, -4017, -4006, -3995, -3983, -3970, -3956, -3942, -3927, -3912,
-3896, -3879, -3861, -3843, -3824, -3804, -3784, -3763, -3742, -3720, -3697, -3674, -3650, -3625, -3600, -3574,
-3547, -3520, -3492, -3464, -3435, -3406, -3376, -3345, -3314, -3282, -3250, -3217, -3183, -3149, -3115, -3080,
-3044, -3008, -2971, -2934, -2896, -2858, -2820, -2780, -2741, -2701, -2660, -2619, -2578, -2536, -2493, -2451,
-2408, -2364, -2320, -2276, -2231, -2186, -2140, -2094, -2048, -2001, -1954, -1907, -1860, -1812, -1763, -1715,
-1666, -1617, -1567, -1518, -1468, -1418, -1367, -1317, -1266, -1215, -1163, -1112, -1060, -1008, -956, -904,
-852, -799, -746, -694, -641, -588, -535, -481, -428, -375, -321, -268, -214, -161, -107, -54 };


Uint32 fs = DSK6713_AIC23_FREQ_48KHZ;
short Xn;
short XnBuffer[N];
Uint16 i, j, GAIN = 7, STEP = 1, d = 0;

interrupt void c_int11()
{
	Xn = GAIN * SinTable[j];
	XnBuffer[i] = Xn;
	i = (i + 1) % N;
	j = (i * STEP) % N;
	output_left_sample(Xn);

	d++;
	if(d == 48000){
		d = 0;
		STEP = (STEP + 1) % 200;
	}
	return;
}

main()
{
	i = 0; GAIN = 7; STEP = 1; d = 0;
	comm_intr();
	while(1);
}
